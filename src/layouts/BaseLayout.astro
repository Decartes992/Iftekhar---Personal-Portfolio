---
// src/layouts/BaseLayout.astro
import '../styles/global.css'; // Import global styles
import { ViewTransitions } from 'astro:transitions'; // Import ViewTransitions
import Header from '../components/Header.astro'; // Import the new Header component
import Footer from '../components/Footer.astro';

// Define props the layout accepts, e.g., title
interface Props {
  title: string;
  description?: string;
  ogTitle?: string;
  ogDescription?: string;
  ogImage?: string;
}

const {
  title,
  description = 'Iftekhar - Personal Portfolio',
  ogTitle = title,
  ogDescription = description,
  ogImage = '/images/og-default.png'
} = Astro.props as Props;
---
<!doctype html>
<html lang="en"> {/* Remove default data-theme here, let the script handle it */}
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width, initial-scale=1" /> {/* Ensure responsiveness */}
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
                <meta name="generator" content={Astro.generator} />
                {/* Font preconnect & preload */}
                <link rel="preconnect" href="https://fonts.googleapis.com">
                <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                <link rel="preload" href="/fonts/InterVariable.woff2" as="font" type="font/woff2" crossorigin>
                <link rel="preload" href="/fonts/SatoshiVariable.woff2" as="font" type="font/woff2" crossorigin>
                <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Satoshi:wght@400;500;700&display=swap" rel="stylesheet">
                <meta name="theme-color" content="#ffffff" id="theme-color-meta" />
                <meta property="og:title" content={ogTitle} />
                <meta property="og:description" content={ogDescription} />
                <meta property="og:image" content={ogImage} />
                <meta name="twitter:card" content="summary_large_image" />
                <meta name="twitter:title" content={ogTitle} />
                <meta name="twitter:description" content={ogDescription} />
                <meta name="twitter:image" content={ogImage} />
                <title>{title} | Iftekhar - Personal Portfolio</title> {/* Add site title suffix */}
		{/* Astro View Transitions for page transitions */}
		<ViewTransitions fallback="animate" />
                {/* Inline script for immediate theme application to prevent FOUC */}
                <script is:inline>
      const getInitialTheme = () => {
        try {
          const stored = localStorage.getItem('theme-preference');
          if (stored) return stored;
        } catch {}
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      };
      const applyTheme = (theme) => {
        document.documentElement.setAttribute('data-theme', theme);
        document.documentElement.classList.toggle('dark', theme === 'dark');
        const meta = document.getElementById('theme-color-meta');
        if (meta) {
          const color = getComputedStyle(document.documentElement).getPropertyValue('--clr-bg-base-current').trim();
          meta.setAttribute('content', color || '#ffffff');
        }
      };
      applyTheme(getInitialTheme());
                </script>
	</head>
	<body>
		{/* Skip link for accessibility */}
		<a href="#main-content" class="skip-link">Skip to main content</a>
		<Header /> {/* Use the new Header component */}
		{/* <header>
			<div class="container">
			</div>
		</header> */}
		<main id="main-content"> {/* Add id for skip links */}
			<slot /> {/* Use slot for page content */}
		</main>
                <Footer />
                <script type="module" src="/scripts/update-timestamp.js" defer></script>
                {/* Deferred script for theme toggle functionality */}
                <script src="/scripts/theme-toggle.js" defer></script> {/* Load deferred */}
                {/* Script for Astro View Transitions class toggling */}
                <script is:inline>
                        document.addEventListener('astro:page-load', () => {
                                document.documentElement.classList.remove('is-animating');
                        });
                        document.addEventListener('astro:before-swap', (e) => {
                                document.documentElement.classList.add('is-animating');
                        });
                </script>
                <script type="module" src="/scripts/button-pulse.js" defer></script>
        </body>
</html>