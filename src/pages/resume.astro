---
// src/pages/resume.astro
import BaseLayout from '../layouts/BaseLayout.astro';
import InteractiveResumeSection from '../components/InteractiveResumeSection.jsx';
import { resumeData, type Skill, type Certification, type EducationEntry, type TimelineEntry } from '../data/aboutData.ts';

const pageTitle = "Resume | Iftekhar's Portfolio";
const pageDescription = "Detailed resume of Iftekhar, showcasing skills, experience, projects, and education in software and electrical engineering.";

// Helper to group skills by category
const skillsByCategory: Record<string, Skill[]> = resumeData.skills.reduce((acc, skill) => {
  const category = skill.category || 'Other';
  if (!acc[category]) {
    acc[category] = [];
  }
  acc[category].push(skill);
  return acc;
}, {} as Record<string, Skill[]>);
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-16">
    <header class="text-center mb-16 md:mb-20" data-aos="fade-down">
      <h1 class="text-5xl md:text-6xl font-bold text-text-headings dark:text-text-dark-headings mb-6 tracking-tight">My Resume</h1>
      <p class="text-lg md:text-xl text-text-secondary dark:text-text-dark-secondary max-w-3xl mx-auto leading-relaxed">
        A comprehensive overview of my professional journey, skills, and academic achievements in the fields of software and electrical engineering.
      </p>
      <div class="mt-8">
        <a href="/Iftekhar_Resume.pdf" target="_blank" rel="noopener noreferrer" 
           class="inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:focus:ring-offset-bg-dark transition-transform transform hover:scale-105 shadow-lg">
          Download PDF Resume
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
          </svg>
        </a>
      </div>
    </header>

    <!-- Skills Section -->
    <InteractiveResumeSection title="Skills Showcase" client:load initiallyOpen={true}>
      <div class="space-y-8">
        {Object.entries(skillsByCategory).map(([category, skills]) => (
          <div class="p-4 bg-bg-alt dark:bg-bg-dark-alt rounded-lg shadow-sm">
            <div class="flex items-center mb-3">
              <div class="h-6 w-6 text-primary-600 dark:text-primary-400 mr-3">
                <!-- Icon placeholder based on category -->
                {category === "Programming Languages" && "üíª"}
                {category === "Frameworks/Libraries" && "üîß"}
                {category === "Tools/Platforms" && "üõ†Ô∏è"}
                {category === "Methodologies" && "üìä"}
                {category === "Software" && "‚ú®"}
                {category === "Hardware" && "üîå"}
                {category === "Soft Skills" && "üë•"}
                {category === "Other" && "üí°"}
              </div>
              <h4 class="text-lg font-semibold text-text-headings dark:text-text-dark-headings">{category}</h4>
            </div>
            <ul class="flex flex-wrap gap-2">
              {skills.map(skill => (
                <li class="bg-tag-bg dark:bg-tag-dark-bg text-tag-text dark:text-tag-dark-text px-3 py-1.5 rounded-full text-sm font-medium">
                  {skill.name}
                </li>
              ))}
            </ul>
          </div>
        ))}
      </div>
    </InteractiveResumeSection>

    <!-- Work Experience Section -->
    <InteractiveResumeSection title="Work Experience" client:load initiallyOpen={true}>
      <div class="space-y-8">
        {resumeData.workExperience.map((exp, index) => (
          <div class="p-5 border border-border dark:border-border-dark rounded-lg shadow-md bg-card dark:bg-card-dark">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-2">
              <h4 class="text-xl font-semibold text-primary-700 dark:text-primary-300">{exp.role}</h4>
              <p class="text-sm text-text-muted dark:text-text-dark-muted mt-1 sm:mt-0">{exp.period}</p>
            </div>
            <p class="text-md font-medium text-text-secondary dark:text-text-dark-secondary mb-1">{exp.entity} - <span class="italic">{exp.location}</span></p>
            <ul class="list-disc list-outside ml-5 space-y-1.5 text-text-base dark:text-text-dark-base mt-3">
              {exp.points.map(resp => <li>{resp}</li>)}
            </ul>
            {exp.technologies && exp.technologies.length > 0 && (
              <div class="mt-4 pt-3 border-t border-border-subtle dark:border-border-dark-subtle">
                <h5 class="text-sm font-semibold text-text-muted dark:text-text-dark-muted mb-2">Key Technologies:</h5>
                <div class="flex flex-wrap gap-2">
                  {exp.technologies.map(tech => (
                    <span class="text-xs bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 px-2.5 py-1 rounded-full font-medium">
                      {tech}
                    </span>
                  ))}
                </div>
              </div>
            )}
          </div>
        ))}
      </div>
    </InteractiveResumeSection>

    <!-- Academic Projects Section -->
    <InteractiveResumeSection title="Academic & Personal Projects" client:load>
      <div class="space-y-8">
        {resumeData.academicProjects.map(project => (
          <div class="p-5 border border-border dark:border-border-dark rounded-lg shadow-md bg-card dark:bg-card-dark">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-2">
              <h4 class="text-xl font-semibold text-primary-700 dark:text-primary-300">{project.role}</h4>
              <p class="text-sm text-text-muted dark:text-text-dark-muted mt-1 sm:mt-0">{project.period}</p>
            </div>
            <p class="text-md font-medium text-text-secondary dark:text-text-dark-secondary mb-1">{project.entity}</p>
            <ul class="list-disc list-outside ml-5 space-y-1.5 text-text-base dark:text-text-dark-base mt-3">
              {project.points.map((highlight: string) => <li>{highlight}</li>)}
            </ul>
            {project.technologies && project.technologies.length > 0 && (
              <div class="mt-4 pt-3 border-t border-border-subtle dark:border-border-dark-subtle">
                <h5 class="text-sm font-semibold text-text-muted dark:text-text-dark-muted mb-2">Key Technologies:</h5>
                <div class="flex flex-wrap gap-2">
                  {project.technologies.map(tech => (
                    <span class="text-xs bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 px-2.5 py-1 rounded-full font-medium">
                      {tech}
                    </span>
                  ))}
                </div>
              </div>
            )}
          </div>
        ))}
      </div>
    </InteractiveResumeSection>

    <!-- Education Section -->
    <InteractiveResumeSection title="Education" client:load>
      <div class="space-y-8">
        {resumeData.education.map(edu => (
          <div class="p-5 border border-border dark:border-border-dark rounded-lg shadow-md bg-card dark:bg-card-dark">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-2">
              <h4 class="text-xl font-semibold text-primary-700 dark:text-primary-300">{edu.degree}</h4>
              <p class="text-sm text-text-muted dark:text-text-dark-muted mt-1 sm:mt-0">{edu.period}</p>
            </div>
            <p class="text-md font-medium text-text-secondary dark:text-text-dark-secondary mb-1">{edu.institution}</p>
            {edu.gpa && <p class="text-sm text-text-muted dark:text-text-dark-muted">GPA: {edu.gpa}</p>}
            {edu.details && edu.details.length > 0 && (
              <ul class="list-disc list-outside ml-5 space-y-1 text-text-base dark:text-text-dark-base mt-3">
                {edu.details.map(detail => <li>{detail}</li>)}
              </ul>
            )}
          </div>
        ))}
      </div>
    </InteractiveResumeSection>

    <!-- Certifications Section -->
    <InteractiveResumeSection title="Certifications" client:load>
      <div class="space-y-6">
        {resumeData.certifications.map(cert => (
          <div class="p-5 border border-border dark:border-border-dark rounded-lg shadow-md bg-card dark:bg-card-dark flex items-center">
            <div class="h-8 w-8 text-green-500 dark:text-green-400 mr-4 flex-shrink-0">‚úÖ</div>
            <div>
              <h4 class="text-lg font-semibold text-text-headings dark:text-text-dark-headings">{cert.name}</h4>
              <p class="text-sm text-text-muted dark:text-text-dark-muted">{cert.issuer}{cert.date ? ` - ${cert.date}` : ''}</p>
              {cert.url && <a href={cert.url} target="_blank" rel="noopener noreferrer" class="text-sm text-primary-600 dark:text-primary-400 hover:underline">View Credential</a>}
            </div>
          </div>
        ))}
      </div>
    </InteractiveResumeSection>

  </div>
</BaseLayout>

<style>
  /* Add any page-specific styles here if needed */
  /* For example, to ensure prose styles inside InteractiveResumeSection are scoped if necessary */
  .prose ul > li::before {
    background-color: var(--color-text-muted) !important;
  }
  .dark .prose ul > li::before {
    background-color: var(--color-text-dark-muted) !important;
  }
</style>